---
- name: "Fileset facts on AIX"
  hosts: d68bay02.aus.stglabs.ibm.com
  gather_facts: no
  
  collections:
  - ibm.power_aix
  
  tasks:
  - name: Gather the fileset facts
    lpp_facts:
  - name: Check whether a fileset called 'openssh.base.client' is installed
    debug:
      msg: Fileset 'openssh.base.client' is installed
    when: "'openssh.base.client' in ansible_facts.filesets"

  - name: Populate fileset facts with the installation state for the most recent
         level of installed filesets for all of the bos.rte filesets
    lpp_facts:
      filesets: bos.rte.*
  - name: Print the fileset facts
    debug:
       var: ansible_facts.filesets
       
  - name: Populate fileset facts with the installation state for the most recent
         level of installed filesets for all of the bos.rte filesets and also with
         the requisites details
    lpp_facts:
      filesets: bos.rte.*
      reqs: True    
  - name: Print the fileset facts
    debug:
       var: ansible_facts.filesets

  - name: Populate fileset facts with the installation state for all the filesets
         contained in the Server bundle
    lpp_facts:
      bundle: Server
  - name: Print the fileset facts
    debug:
      var: ansible_facts.filesets
  
  - name: Populate fixes facts with the status of APAR fixes installed on the system
    lpp_facts:
      fix_type: apar
  - name: Print the fixes facts
    debug:
      var: ansible_facts.fixes